# upbit-api , 자동매매 (Backend)

## 환경 설정
```
.env 파일 생성후 Upbit Key 기입 , GCP gmail 알람 사용시 해당 App 패스워드 입력
AccessKey=""
SecretKey=""
GmailAppPassword=""
```

## 기존 자동매매

1. 매시간 마다 전날 대비 많이 내린 코인 6천원 매수
2. 구매한 코인중 -12퍼가 넘어갈시 6천원 다시 매수 , 20퍼 오를시 해당 마켓 코인 매도
   - -12퍼가 넘어가는 코인은 00시,06시,12시,18시 기준으로 6시간 마다 6천원 매수로 수정 (장이 안좋은 경우 대비)
3. 실시간으로 핫한 코인 알람

- ~~서버 없어서 aws 람다로 돌리려다가 집나간 맥북이 돌아와서 람다 코드는 무시~~

```go
cmd/autoTrading/main.go
```

## 스윙 자동매매

1. 미국시간 00시 1초 지나간 지나간 n일의 저점,종가,고가의 평균 및 현재가를 가져옴
   - 전체코인 가져오는 부분(시세 캔들 조회 API) API 초당 30회 제공이라고 적혀있지만 아닌듯? 요청횟수 초과 페일오버 구축
2. 데이터 지정가 매수 체결 대기 걸기
   - 맵에 모든 코인들 상태값 저장
   - 종가 평균이 저점 평균 보다 높고 고점 평균보다 낮은 경우, 그리고 금일 시작가와 종가의 평균 편차가 0.5% 내외면 모니터링 진입
   - 종가 평균과 고가 평균의 차이가 4퍼 이상인 경우에만 매수 체결 대기 및 해당 코인 데이터베이스 업데이트
3. 매수체결이 된 경우 매도 대기 걸기
   - API 로는 매수가 된 경우를 바로 가져올수 없어서 거래내역 API 를 조회해 1분마다 매수 체결된 데이터 데이터베이스 업데이트
   - 이후 기록된 n일의 고가의 평균에서 1퍼를 뺀 값으로 매도 대기 걸기
4. 매도 데이터 저장
   - 매시간마다 매도 데이터 데이터베이스 업데이트
5. 미국시간 23시 55분 기준 모든 매수대기,매수,매도대기 데이터 초기화
   - 매수대기 일시 해당 데이터 초기화
   - 매수만 되었을 경우 시장가로 매도후 초기화
   - 매도대기 데이터 초기화

- TODO : 맵에 들어갔지만 해당 조건을 만족하지 않은 경우 (종가 평균이 저점평균 보다 높고 고가평균보다 금일 시작가와 종가평균의 편차가 0.5% 가 아닌경우)
- 해당 상태값들 가져와서 현재가가 저점의 평균보다 낮은경우 매수 (초기화 이후 폭락한 경우)

```go
cmd/autoTrading2/main.go
```